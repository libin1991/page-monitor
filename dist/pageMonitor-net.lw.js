!function(e){var r=e.BDWMMonitor,t=window.location,n=window.performance||window.webkitPerformance||window.msPerformance||window.mozPerformance;r.define("net",function(){var i=["script","link","xmlhttprequest"],a=["resource","measure"],s=500;return{run:function(){var e=this;this.resourceHook(),setTimeout(function(){e.initjQueryAjaxHook(),e.initjQueryObserve()},500)},resourceHook:function(){window.addEventListener("error",function(e){var n=e.srcElement||e.target;if(n instanceof HTMLElement){var o=n.tagName.toLowerCase();/script|link|img/.test(o)&&r.report("exception",{tag:"resource_error",url:n.src||n.href,purl:t.href,err_status:"404",err_msg:"Not Found"})}},!0),this.initPerfObserve(),this.resourceLoadAdapter(!0),this.resourceLoadAdapter(!1)},resourceLoadAdapter:function(r){var t=function(){},n=function(){},o="_resourceLoadSucc",i="_resourceLoadFail",a=r?o:i,s=r?t:n;
if(e[a]){var u=e[a];e[a]=function(e){u(e),s(e)}}else e[a]=s},resourceObserver:function(){},initjQueryObserve:function(){var e=this;(window.jQuery||window.Zepto)&&$(document).ajaxComplete(function(r,t,n){var o=e.getLastEntryByUrl(n.url);o&&e.analyzePerfEntry(o)})},initjQueryAjaxHook:function(){(window.jQuery||window.Zepto)&&$(document).ajaxError(function(e,n,o,i){r.report("exception",{tag:"xhr",url:o.url,purl:t.href,err_status:n.status,err_txt:n.statusText})})},analyzePerfEntry:function(e){var t=e.duration;t>s&&r.report("resource",{tag:"resource_timing",p_lookup:e.domainLookupEnd-e.domainLookupStart,p_tcp:e.connectEnd-e.connectStart,p_ssl:e.secureConnectionStart>0?e.connectEnd-e.secureConnectionStart:0,p_ttfb:e.responseStart-e.requestStart,p_download:e.responseEnd-e.responseStart,p_to_download:t,
p_to_connect:e.connectEnd-e.fetchStart,url:e.name})},initPerfObserve:function(){var e=this;if(window.PerformanceObserver){var r=new window.PerformanceObserver(function(r){for(var t=r.getEntriesByType("resource"),n=0;n<t.length;n++){var o=t[n];/log\.waimai\.baidu\.com/.test(o.name)||i.indexOf(o.initiatorType)!=-1&&e.analyzePerfEntry(o)}});r.observe({entryTypes:a})}},getLastEntryByUrl:function(e){var r=null;return n.getEntries().some(function(t){if(t.name==o.resolvePath(e))return r=t,!0}),r},xhrHook:function(){}}});var o={resolvePath:function(e){var r=/^(?:[\.]{1,2}\/?)*\/?\w+/,n=/^http(?:s)?:\/\//;if(!r.test(e)||n.test(e))return e;var o=t.href.split("/"),i=e.split("/"),a=0;return/^\.{1,2}$/.test(i[0])?(i.some(function(e){".."==e&&a++}),o=o.slice(0,Math.max(3,o.length-a-1)),o.push(i[i.length-1])):/^\/.+/.test(e)?(o=[t.protocol+"//"+t.host],
o.push(e.substr(1))):(o=o.slice(0,o.length-1),o.push(e)),o.join("/")}}}(window);